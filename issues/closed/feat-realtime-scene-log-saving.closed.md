# feat: ターンごとの即座シーンログ保存機能

## 概要
シミュレーション実行中にターンが進むたびに、即座にシーンログをファイルに保存する機能を実装。これにより、シミュレーション途中でクラッシュした場合でもデータが失われることを防ぐ。

## 要求
- 新しいシミュレーションが始まったら即座にシミュレーションファイルが生成される
- ターン実行するたびにそのターン情報がシミュレーションフォルダに追記される
- 介入情報も即座に保存される
- エラーが発生してもシミュレーションは継続する

## 実装内容

### 1. SimulationEngineクラスの改良
- `_simulation_id`と`_simulation_log_directory`プロパティを追加
- `_initialize_simulation_logging()`メソッドでシミュレーション開始時にIDとディレクトリを生成
- `_save_scene_log_realtime()`メソッドでエラーハンドリング付きの即座保存機能
- `start_simulation_setup()`で初期ログファイルを作成
- `next_turn()`でターン実行後に自動保存
- `process_user_intervention()`で介入後に自動保存
- `end_simulation()`でシミュレーション状態をリセット

### 2. ログ保存の改良
- `_save_scene_log()`メソッドで既存のシミュレーションIDを使用
- フォールバック機能で従来の方式も維持

### 3. テストの追加
- リアルタイムログ機能の初期化テスト
- ターン実行時の自動保存テスト
- エラーハンドリングテスト
- シミュレーションID一貫性テスト
- 状態リセットテスト

## テスト内容
- 単体テスト: `test_realtime_logging_*`系のテストが全て成功
- 手動テスト: `examples/manual_test_simulation_engine.py`で動作確認済み
- ログファイルが正しく生成され、ターンごとに更新されることを確認

## 確認事項
✅ シミュレーション開始時に即座にログファイルが生成される
✅ ターンごとにログファイルが更新される
✅ 介入後にログファイルが更新される
✅ エラーが発生してもシミュレーションが継続する
✅ 既存のテストが全て通る
✅ 新しいテストが追加され、全て成功する
✅ 手動テストで実際の動作を確認済み 